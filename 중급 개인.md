# 1. 프로젝트 개요

DearCarmate는 중고차 거래 회사에서 계약, 차량, 고객 등의 정보를 관리 및 수정하기 위해 사용하는 서비스입니다. 직원은 계약, 차량, 고객의 등록 및 수정이 가능하며, 대시보드로 정보를 한 눈에 볼 수 있습니다. 간단한 개인정보 수정이 가능합니다. 사이트의 관리자는 가입된 사용자의 조회, 탈퇴가 가능하며 회사의 추가, 삭제도 가능합니다.

# 2. 담당한 작업

## 개인 작업

- users api 구현
- auth api 구현
- dashboard api 구현
- swagger 작성
- 이미지 업로드 개선

## 협업

- 초기 ERD 설계
- 프로젝트 계획서 작성
- 상호 코드 리뷰 및 보완
- swagger 작성 및 적용
- 전체 디버깅 및 코드 품질 보완
- DTO 활용방식 통일

# 3. 기술적 성과

- nodejs, express, TypeScript, prisma, postgreSQL
- 명세에 기재된 기능 및 프론트 서버와의 원활한 연결을 위한 일부 코드 수정
- 프론트에서의 직관성을 위한 이미지명 보존 및 MIME type 검증
- swagger 페이지
- 배포

# 4. 문제점 및 해결과정

다양한 문제가 발생하였지만 그 중 몇 가지를 기술합니다.

1. ERD
   초기에 안내된 잘못된 예시 ERD와 팀원 간의 의견 불일치로 인해 ERD 설계와 관한 토론이 있었습니다. 주 쟁점은 CAR 엔티티로부터 차량, 차종, 제조사를 분리할지, 한다면 어느 정도로 할지 였습니다. 코드의 복잡도 증가나 직관성을 근거로 제시해주신 팀원분들께 정규화 측면에서 장점과 그렇게 하지 않았을 경우에 일어날 일들을 예시로 들며 설득을 진행했습니다.
   이틀 간의 대화 끝에 정규화를 진행하는 것으로 결정되었습니다. ERD를 위해 소요된 시간이 적지 않다고 생각하지만, 중간 발표 당시 다른 팀과 비교하여 제3정규형까지 만족했다는 점과 개발 마무리 단계까지 ERD가 크게 변화하지 않아 나중에 뜯어고치는 형태의 작업도 없었다는 점이 그 시간에 대한 성과라고 생각합니다.

2. mimeType 라이브러리 로컬환경 차이
   업로드된 파일의 mimeType을 검증하는 기능을 위해 외부 라이브러리를 적용했습니다. 그런데 알 수 없는 이유로 팀원의 로컬에서는 오류가 발생했습니다. 환경적인 원인으로 추측되어 이 부분은 강사님께 질문을 드렸습니다. 해당 라이브러리를 사용하지 않는 것도 하나의 방법일 수 있다는 답변을 받았습니다.
   질문으로 해결된 문제이지만, 라이브러리 사용에 문제가 있으면 사용하지 않으면 된다는 간단한 생각을 제가 하지 못했다는 점이 기억에 남아 작성하게 되었습니다. 문제가 발생했을 때 해결하는 것, 그리고 탐구하는 자세도 중요하지만 강사님께서 말씀하신 대로 개발자의 시간은 한정되어 있고 빠르게 해결할 수 있는 다른 방법이 있다면 그러지 않을 이유가 없다는 점을 기억할것입니다.

3. 트랜잭션과 prismaClient 확장과의 충돌
   트랜잭션 구현을 위해 prisma에서 제공하는 방법으로 prismaClient를 활용하는 도중 문제가 발생했습니다. 저희는 기존에 이 인스턴스를 확장하여 엔티티의 이름을 리턴하는 함수를 포함시켜 사용하고 있었습니다. 그런데 트랜잭션 함수를 호출할 인스턴스가 확장되어 있으면 타입 관련 에러가 발생합니다.
   이에 대해 인스턴스를 둘 이상을 사용할지 확장을 제거할지 고민했고, 후자로 결정하였습니다. 엔티티의 이름을 리턴하는 기능은 매번 문자열로 작성하는 것보다, 변수로 작성하는 것이 오타도 방지하고 깔끔하기 때문이었습니다. 하지만 이런 형태의 하드 코딩은, 문자 하나만 틀리면 에러가 발생하는 종류의 것이 아니라 단순히 메세지로 보여지는 문자열이기 때문에 중요도가 낮다고 생각되었습니다.

# 5. 협업 및 피드백

## 팀원 간의 부족한 소통

초기에 ERD와 관한 토론을 진행할 때, 한 팀원은 예비군 일정으로 인해 참석하지 못했습니다. 차주에 결정된 사안들을 공유하고 개발을 진행하였는데 문제가 발생했습니다. 메인 개발 기간에 해당하는 1주일이 지난 후에 팀원께서 올려주신 커밋의 내용은 기존 ERD를 비정규화하여 개발된 상태였습니다. 팀원께서는 토론 이전의 비정규화를 제안했던 다른 팀원분처럼 정규화의 장점을 동의하지 않고 계셔서 임의로 수정하신 것입니다.

주요 사항은 다음과 같습니다.

- 다른 팀원에게 영향을 주는 ERD를 상의 없이 변경
- 변경한 방향이 비정규화
- 개발하신 내용이 메인 개발기간 일주일 분량의 코드

원인은 아래와 같이 정리할 수 있습니다.

- 다른 팀원과 달리 push를 마지막에 한번에 하셔서 팀원들이 진척상황(코드내용)을 확인하지 못함
- 결정된 사안들을 좀 더 확실하게 공유하지 않음

결과적으로 해당 부분은 다시 개발해주시는 것으로 해결되었습니다.

이러한 상황은 개발 방법론적인 지식이 부족하여 발생하였다고 생각됩니다. 마침 멘토님께서 이 이슈와 별개로 에자일 방법론에 관해 설명해주셨는데, 관련 지식이 있었다면 충분히 예방되었을 일일 것입니다. 다음 프로젝트에서는 트렐로라는 이슈 트레커의 방식을 노션에 적용하여 진행하는 경험을 해보려 합니다.

## 분량과 성취, 속도차이

초급 프로젝트의 경험을 바탕으로, 이번에는 개인 분량에 많은 시간을 분배하는 대신, 작업마다 비교적 균등한 시간을 할애하도록 계획을 세웠습니다. 하지만 그 의미는 당연히 개인 개발시간이 줄어든다는 것이고, 속도차이가 있기 때문에 기간안에 작업을 완료하지 못하는 인원이 발생하게 되었습니다. 이후 디버깅 등을 위한 시간은 늘었지만 초기 목적이었던 충분한 디버깅 경험은, 결국 기간안에 개인 개발을 마무리한 인원만이 가능했습니다.
초급, 중급 프로젝트의 시도를 통해, 각 팀원의 성취와 생산성을 위해서는 속도에 따라 균등하지 않은 분량을 부여해야 할 것으로 보입니다. 다만 이에 대해 동의하지 않을 팀원이 있을 것으로 예상되기 때문에, 최종 프로젝트에서는 이 상황을 해쳐나가는 경험을 염두하며 진행할 계획입니다.

# 6. 코드 품질 및 최적화

DTO에 대해 팀 내에 합의가 필요하다는 사실을 모르는 상태로 진행하여 DTO활용 방식이 통일되지 않았습니다. 이후 리팩토링과정에서 몇 가지 규칙을 설정하여 통일시켰습니다.

자주 사용되는 로직을 모듈화하여 분리했습니다. 하지만 테스트가 진행되면서, 모듈로 커버가 안되는 예외적인 상황이 등장했고, 결국 일부 상황에 대해서만 활용되는 모듈이 되어버렸습니다.

리팩토링까지 진행할 여력이 있는 인원이 많지 않다보니 누락된 부분이 남아있습니다.

# 7. 향후 개선 사항 및 제안

작성한대로 리펙토링을 마무리하지 못해 아쉬운 점이 있습니다.
타입 활용 방식에 대해 통일하지 못한 점도 있습니다.
파일 업로드와 관련하여 디렉토리 경로를 통일하지 못했습니다.
대용량 업로드에서 차량과 고객의 multer활용을 통일하지 못했습니다.
개선한다면 코드 품질 관점에서 할 수 있는 부분이 있을 것입니다.
